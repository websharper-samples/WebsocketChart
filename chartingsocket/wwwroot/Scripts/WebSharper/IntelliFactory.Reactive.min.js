(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;b=a.IntelliFactory=a.IntelliFactory||{};c=b.Reactive=b.Reactive||{};d=c.Disposable=c.Disposable||{};e=c.Observer=c.Observer||{};f=c.HotStream=c.HotStream||{};g=a.WebSharper;h=g&&g.Obj;i=c.Reactive=c.Reactive||{};j=i.Reactive=i.Reactive||{};k=a.StartupCode$IntelliFactory_Reactive$Reactive=a.StartupCode$IntelliFactory_Reactive$Reactive||{};l=b&&b.Runtime;m=g&&g.Control;n=m&&m.FSharpEvent;o=g&&g.Util;p=g&&g.List;q=g&&g.Collections;r=q&&q.Dictionary;s=g&&g.Seq;d.New=function(t){return{Dispose:function(){return t();}};};e.New=function(t,u){return{OnNext:t,OnCompleted:function(){return u();},OnError:function(){return null;}};};f=c.HotStream=l.Class({Trigger:function(t){this.Latest[0]={$:1,$0:t};this.Event.event.Trigger(t);},Subscribe:function(t){this.Latest[0]!=null?t.OnNext(this.Latest[0].$0):void 0;return this.Event.event.Subscribe(t);}},null,f);f.New$1=function(t){return f.New([{$:1,$0:t}],new n.New());};f.New$2=function(){return f.New([null],new n.New());};f.New=function(t,u){return new f({Latest:t,Event:u});};j=i.Reactive=l.Class({Sequence:function(t){return i.Sequence(t);},Drop:function(t,u){return i.Drop(t,u);},Aggregate:function(t,u,v){return i.Aggregate(t,u,function(w,x){return(v(w))(x);});},Heat:function(t){return i.Heat(t);},CombineLatest:function(t,u,v){return i.CombineLatest(t,u,function(w,x){return(v(w))(x);});},CollectLatest:function(t){return i.CollectLatest(t);},SelectMany:function(t){return i.SelectMany(t);},Switch:function(t){return i.Switch(t);},Merge:function(t,u){return i.Merge(t,u);},Concat:function(t,u){return i.Concat(t,u);},Where:function(t,u){return i.Where(t,u);},Choose:function(t,u){return i.Choose(t,u);},Select:function(t,u){return i.Select(t,u);},Never:function(){return i.Never();},Return:function(t){return i.Return(t);}},h,j);j.New=l.Ctor(function(){h.New.call(this);},j);i.Default=function(){k.$cctor();return k.Default;};i.Heat=function(t){var u;u=f.New$2();t.Subscribe(o.observer(function(v){u.Trigger(v);}));return u;};i.Sequence=function(t){function u(v){return v.$==1?i.CombineLatest(v.$0,u(v.$1),function(w,x){return new p.T({$:1,$0:w,$1:x});}):i.Return(p.T.Empty);}return i.Select(u(p.ofSeq(t)),a.id);};i.CollectLatest=function(t){return{Subscribe:function(u){var v,w;v=new r.New$5();w=[0];return t.Subscribe(o.observer(function(x){var y;w[0]++;y=w[0];x.Subscribe(o.observer(function(z){v.set_Item(y,z);u.OnNext(s.delay(function(){return s.map(function(A){return A.V;},v);}));}));}));}};};i.Aggregate=function(t,u,v){return{Subscribe:function(w){var x;x=[u];return t.Subscribe(o.observer(function(y){x[0]=v(x[0],y);w.OnNext(x[0]);}));}};};i.SelectMany=function(t){return{Subscribe:function(u){var v,w;v=[a.ignore];w=t.Subscribe(o.observer(function(x){var y;y=x.Subscribe(o.observer(function(z){u.OnNext(z);}));v[0]=function(){v[0]();y.Dispose();};}));return d.New(function(){v[0]();w.Dispose();});}};};i.Switch=function(t){return{Subscribe:function(u){var v,w;v=[0];w=[null];return t.Subscribe(o.observer(function(x){var y;v[0]++;if(w[0]!=null)w[0].$0.Dispose();y=v[0];w[0]={$:1,$0:x.Subscribe(o.observer(function(z){if(y===v[0])u.OnNext(z);}))};}));}};};i.CombineLast=function(t,u,v){return{Subscribe:function(w){var x,y,z,A;function B(){if(x.length>0&&y.length>0)w.OnNext(v(x.shift(),y.shift()));}x=[];y=[];z=t.Subscribe(e.New(function(C){x.push(C);B();},a.ignore));A=u.Subscribe(e.New(function(C){y.push(C);B();},a.ignore));return d.New(function(){z.Dispose();A.Dispose();});}};};i.CombineLatest=function(t,u,v){return{Subscribe:function(w){var x,y,z,A;function B(){var C,D;C=x[0];D=y[0];if(C!=null&&C.$==1)D!=null&&D.$==1?w.OnNext(v(C.$0,D.$0)):void 0;}x=[null];y=[null];z=t.Subscribe(e.New(function(C){x[0]={$:1,$0:C};B();},a.ignore));A=u.Subscribe(e.New(function(C){y[0]={$:1,$0:C};B();},a.ignore));return d.New(function(){z.Dispose();A.Dispose();});}};};i.Range=function(t,u){return{Subscribe:function(v){var w,x;for(w=t,x=t+u;w<=x;w++)v.OnNext(w);return d.New(a.ignore);}};};i.Concat=function(t,u){return{Subscribe:function(v){var w,x;w=[null];x=t.Subscribe(e.New(function(y){v.OnNext(y);},function(){w[0]={$:1,$0:u.Subscribe(v)};}));return d.New(function(){w[0]!=null?w[0].$0.Dispose():void 0;x.Dispose();});}};};i.Merge=function(t,u){return{Subscribe:function(v){var w,x,y,z;w=[false];x=[false];y=t.Subscribe(e.New(function(A){v.OnNext(A);},function(){w[0]=true;w[0]&&x[0]?v.OnCompleted():void 0;}));z=u.Subscribe(e.New(function(A){v.OnNext(A);},function(){x[0]=true;w[0]&&x[0]?v.OnCompleted():void 0;}));return d.New(function(){y.Dispose();z.Dispose();});}};};i.Drop=function(t,u){return{Subscribe:function(v){var w;w=[0];return t.Subscribe(o.observer(function(x){w[0]++;w[0]>u?v.OnNext(x):void 0;}));}};};i.Choose=function(t,u){return{Subscribe:function(v){return t.Subscribe(o.observer(function(w){var x;x=u(w);if(x==null);else v.OnNext(x.$0);}));}};};i.Where=function(t,u){return{Subscribe:function(v){return t.Subscribe(o.observer(function(w){if(u(w))v.OnNext(w);}));}};};i.Select=function(t,u){return{Subscribe:function(v){return t.Subscribe(o.observer(function(w){v.OnNext(u(w));}));}};};i.Never=function(){return{Subscribe:function(){return d.New(a.ignore);}};};i.Return=function(t){return{Subscribe:function(u){u.OnNext(t);u.OnCompleted();return d.New(a.ignore);}};};k.$cctor=function(){k.$cctor=a.ignore;k.Default=new j.New();};}(self));
